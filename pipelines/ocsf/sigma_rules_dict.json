{
  "rules/cloud/aws/cloudtrail/aws_attached_malicious_lambda_layer.yml": "api.service.name=\"lambda.amazonaws.com\" api.operation=\"UpdateFunctionConfiguration*\"",
  "rules/cloud/aws/cloudtrail/aws_cloudtrail_disable_logging.yml": "api.service.name=\"cloudtrail.amazonaws.com\" api.operation IN (\"StopLogging\", \"UpdateTrail\", \"DeleteTrail\")",
  "rules/cloud/aws/cloudtrail/aws_config_disable_recording.yml": "api.service.name=\"config.amazonaws.com\" api.operation IN (\"DeleteDeliveryChannel\", \"StopConfigurationRecorder\")",
  "rules/cloud/aws/cloudtrail/aws_delete_identity.yml": "api.service.name=\"ses.amazonaws.com\" api.operation=\"DeleteIdentity\"",
  "rules/cloud/aws/cloudtrail/aws_ec2_disable_encryption.yml": "api.service.name=\"ec2.amazonaws.com\" api.operation=\"DisableEbsEncryptionByDefault\"",
  "rules/cloud/aws/cloudtrail/aws_ec2_startup_script_change.yml": "api.service.name=\"ec2.amazonaws.com\" requestParameters.attribute=\"userData\" api.operation=\"ModifyInstanceAttribute\"",
  "rules/cloud/aws/cloudtrail/aws_ec2_vm_export_failure.yml": "api.operation=\"CreateInstanceExportTask\" api.service.name=\"ec2.amazonaws.com\" NOT (errorMessage=\"*\" OR errorCode=\"*\" OR responseElements=\"*Failure*\")",
  "rules/cloud/aws/cloudtrail/aws_ecs_task_definition_cred_endpoint_query.yml": "api.service.name=\"ecs.amazonaws.com\" api.operation IN (\"DescribeTaskDefinition\", \"RegisterTaskDefinition\", \"RunTask\") requestParameters.containerDefinitions.command=\"*$AWS_CONTAINER_CREDENTIALS_RELATIVE_URI*\"",
  "rules/cloud/aws/cloudtrail/aws_efs_fileshare_modified_or_deleted.yml": "api.service.name=\"elasticfilesystem.amazonaws.com\" api.operation=\"DeleteFileSystem\"",
  "rules/cloud/aws/cloudtrail/aws_efs_fileshare_mount_modified_or_deleted.yml": "api.service.name=\"elasticfilesystem.amazonaws.com\" api.operation=\"DeleteMountTarget\"",
  "rules/cloud/aws/cloudtrail/aws_eks_cluster_created_or_deleted.yml": "api.service.name=\"eks.amazonaws.com\" api.operation IN (\"CreateCluster\", \"DeleteCluster\")",
  "rules/cloud/aws/cloudtrail/aws_elasticache_security_group_created.yml": "api.service.name=\"elasticache.amazonaws.com\" api.operation=\"CreateCacheSecurityGroup\"",
  "rules/cloud/aws/cloudtrail/aws_elasticache_security_group_modified_or_deleted.yml": "api.service.name=\"elasticache.amazonaws.com\" api.operation IN (\"DeleteCacheSecurityGroup\", \"AuthorizeCacheSecurityGroupIngress\", \"RevokeCacheSecurityGroupIngress\", \"AuthorizeCacheSecurityGroupEgress\", \"RevokeCacheSecurityGroupEgress\")",
  "rules/cloud/aws/cloudtrail/aws_enum_buckets.yml": "api.service.name=\"s3.amazonaws.com\" api.operation=\"ListBuckets\" NOT type=\"AssumedRole\"",
  "rules/cloud/aws/cloudtrail/aws_guardduty_disruption.yml": "api.service.name=\"guardduty.amazonaws.com\" api.operation=\"CreateIPSet\"",
  "rules/cloud/aws/cloudtrail/aws_iam_backdoor_users_keys.yml": "api.service.name=\"iam.amazonaws.com\" api.operation=\"CreateAccessKey\" NOT userIdentity.arn=\"*responseElements.accessKey.userName*\" | table userIdentity.arn,responseElements.accessKey.userName,errorCode,errorMessage",
  "rules/cloud/aws/cloudtrail/aws_iam_s3browser_loginprofile_creation.yml": "api.service.name=\"iam.amazonaws.com\" api.operation IN (\"GetLoginProfile\", \"CreateLoginProfile\") userAgent=\"*S3 Browser*\"",
  "rules/cloud/aws/cloudtrail/aws_iam_s3browser_templated_s3_bucket_policy_creation.yml": "api.service.name=\"iam.amazonaws.com\" api.operation=\"PutUserPolicy\" userAgent=\"*S3 Browser*\" requestParameters=\"*\\\"arn:aws:s3:::<YOUR-BUCKET-NAME>/*\\\"*\" requestParameters=\"*\\\"s3:GetObject\\\"*\" requestParameters=\"*\\\"Allow\\\"*\"",
  "rules/cloud/aws/cloudtrail/aws_iam_s3browser_user_or_accesskey_creation.yml": "api.service.name=\"iam.amazonaws.com\" api.operation IN (\"CreateUser\", \"CreateAccessKey\") userAgent=\"*S3 Browser*\"",
  "rules/cloud/aws/cloudtrail/aws_passed_role_to_glue_development_endpoint.yml": "api.service.name=\"glue.amazonaws.com\" api.operation IN (\"CreateDevEndpoint\", \"DeleteDevEndpoint\", \"UpdateDevEndpoint\")",
  "rules/cloud/aws/cloudtrail/aws_rds_change_master_password.yml": "api.service.name=\"rds.amazonaws.com\" responseElements.pendingModifiedValues.masterUserPassword=\"*\" api.operation=\"ModifyDBInstance\"",
  "rules/cloud/aws/cloudtrail/aws_rds_public_db_restore.yml": "api.service.name=\"rds.amazonaws.com\" responseElements.publiclyAccessible=\"true\" api.operation=\"RestoreDBInstanceFromDBSnapshot\"",
  "rules/cloud/aws/cloudtrail/aws_root_account_usage.yml": "userIdentity.type=\"Root\" NOT eventType=\"AwsServiceEvent\"",
  "rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_lock_disabled.yml": "api.service.name=\"route53.amazonaws.com\" api.operation=\"DisableDomainTransferLock\"",
  "rules/cloud/aws/cloudtrail/aws_route_53_domain_transferred_to_another_account.yml": "api.service.name=\"route53.amazonaws.com\" api.operation=\"TransferDomainToAnotherAwsAccount\"",
  "rules/cloud/aws/cloudtrail/aws_s3_data_management_tampering.yml": "api.service.name=\"s3.amazonaws.com\" api.operation IN (\"PutBucketLogging\", \"PutBucketWebsite\", \"PutEncryptionConfiguration\", \"PutLifecycleConfiguration\", \"PutReplicationConfiguration\", \"ReplicateObject\", \"RestoreObject\")",
  "rules/cloud/aws/cloudtrail/aws_securityhub_finding_evasion.yml": "api.service.name=\"securityhub.amazonaws.com\" api.operation IN (\"BatchUpdateFindings\", \"DeleteInsight\", \"UpdateFindings\", \"UpdateInsight\") | table sourceIPAddress,userIdentity.arn",
  "rules/cloud/aws/cloudtrail/aws_snapshot_backup_exfiltration.yml": "api.service.name=\"ec2.amazonaws.com\" api.operation=\"ModifySnapshotAttribute\"",
  "rules/cloud/aws/cloudtrail/aws_sso_idp_change.yml": "api.service.name IN (\"sso-directory.amazonaws.com\", \"sso.amazonaws.com\") api.operation IN (\"AssociateDirectory\", \"DisableExternalIdPConfigurationForDirectory\", \"DisassociateDirectory\", \"EnableExternalIdPConfigurationForDirectory\")",
  "rules/cloud/aws/cloudtrail/aws_sts_assumerole_misuse.yml": "userIdentity.type=\"AssumedRole\" userIdentity.sessionContext.sessionIssuer.type=\"Role\"",
  "rules/cloud/aws/cloudtrail/aws_sts_getsessiontoken_misuse.yml": "api.service.name=\"sts.amazonaws.com\" api.operation=\"GetSessionToken\" userIdentity.type=\"IAMUser\"",
  "rules/cloud/aws/cloudtrail/aws_susp_saml_activity.yml": "(api.service.name=\"sts.amazonaws.com\" api.operation=\"AssumeRoleWithSAML\") OR (api.service.name=\"iam.amazonaws.com\" api.operation=\"UpdateSAMLProvider\")",
  "rules/cloud/aws/cloudtrail/aws_update_login_profile.yml": "api.service.name=\"iam.amazonaws.com\" api.operation=\"UpdateLoginProfile\" NOT userIdentity.arn=\"*requestParameters.userName*\" | table userIdentity.arn,requestParameters.userName,errorCode,errorMessage",
  "rules/cloud/gcp/audit/gcp_bucket_enumeration.yml": "api.operation IN (\"storage.buckets.list\", \"storage.buckets.listChannels\")",
  "rules/cloud/gcp/audit/gcp_bucket_modified_or_deleted.yml": "api.operation IN (\"storage.buckets.delete\", \"storage.buckets.insert\", \"storage.buckets.update\", \"storage.buckets.patch\")",
  "rules/cloud/gcp/audit/gcp_dlp_re_identifies_sensitive_information.yml": "api.operation=\"projects.content.reidentify\"",
  "rules/cloud/gcp/audit/gcp_dns_zone_modified_or_deleted.yml": "api.operation IN (\"Dns.ManagedZones.Delete\", \"Dns.ManagedZones.Update\", \"Dns.ManagedZones.Patch\")",
  "rules/cloud/gcp/audit/gcp_firewall_rule_modified_or_deleted.yml": "api.operation IN (\"v*.Compute.Firewalls.Delete\", \"v*.Compute.Firewalls.Patch\", \"v*.Compute.Firewalls.Update\", \"v*.Compute.Firewalls.Insert\")",
  "rules/cloud/gcp/audit/gcp_full_network_traffic_packet_capture.yml": "api.operation IN (\"v*.Compute.PacketMirrorings.Get\", \"v*.Compute.PacketMirrorings.Delete\", \"v*.Compute.PacketMirrorings.Insert\", \"v*.Compute.PacketMirrorings.Patch\", \"v*.Compute.PacketMirrorings.List\", \"v*.Compute.PacketMirrorings.aggregatedList\")",
  "rules/cloud/gcp/audit/gcp_kubernetes_admission_controller.yml": "api.operation=\"admissionregistration.k8s.io.v*\" api.operation IN (\"*.mutatingwebhookconfigurations.*\", \"*.validatingwebhookconfigurations.*\") api.operation IN (\"*create\", \"*patch\", \"*replace\")",
  "rules/cloud/gcp/audit/gcp_kubernetes_cronjob.yml": "api.operation IN (\"io.k8s.api.batch.v*.Job\", \"io.k8s.api.batch.v*.CronJob\")",
  "rules/cloud/gcp/audit/gcp_kubernetes_rolebinding.yml": "api.operation IN (\"io.k8s.authorization.rbac.v*.clusterrolebindings.create\", \"io.k8s.authorization.rbac.v*.rolebindings.create\", \"io.k8s.authorization.rbac.v*.clusterrolebindings.patch\", \"io.k8s.authorization.rbac.v*.rolebindings.patch\", \"io.k8s.authorization.rbac.v*.clusterrolebindings.update\", \"io.k8s.authorization.rbac.v*.rolebindings.update\", \"io.k8s.authorization.rbac.v*.clusterrolebindings.delete\", \"io.k8s.authorization.rbac.v*.rolebindings.delete\")",
  "rules/cloud/gcp/audit/gcp_kubernetes_secrets_modified_or_deleted.yml": "api.operation IN (\"io.k8s.core.v*.secrets.create\", \"io.k8s.core.v*.secrets.update\", \"io.k8s.core.v*.secrets.patch\", \"io.k8s.core.v*.secrets.delete\")",
  "rules/cloud/gcp/audit/gcp_service_account_disabled_or_deleted.yml": "api.operation IN (\"*.serviceAccounts.disable\", \"*.serviceAccounts.delete\")",
  "rules/cloud/gcp/audit/gcp_service_account_modified.yml": "api.operation IN (\"*.serviceAccounts.patch\", \"*.serviceAccounts.create\", \"*.serviceAccounts.update\", \"*.serviceAccounts.enable\", \"*.serviceAccounts.undelete\")",
  "rules/cloud/gcp/audit/gcp_sql_database_modified_or_deleted.yml": "api.operation IN (\"cloudsql.instances.create\", \"cloudsql.instances.delete\", \"cloudsql.users.update\", \"cloudsql.users.delete\")",
  "rules/cloud/gcp/audit/gcp_vpn_tunnel_modified_or_deleted.yml": "api.operation IN (\"compute.vpnTunnels.insert\", \"compute.vpnTunnels.delete\")"
}